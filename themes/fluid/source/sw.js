(()=>{"use strict";const e={dev:{blog:!1,accelerator:!1},cache:{name:"Redish101BlogCache",enabled:!0},accelerator:[["https://fastly.jsdelivr.net/gh","https://cdn1.tianli0.top/gh","https://cdn.oplog.cn/gh"],["https://fastly.jsdelivr.net/combine","https://cdn1.tianli0.top/combine","https://cdn.oplog.cn/combine"],["https://fastly.jsdelivr.net/npm","https://gcore.jsdelivr.net/npm","https://npm.elemecdn.com","https://cdn1.tianli0.top/npm","https://cdn.oplog.cn/npm","https://unpkg.com"]],blog:{accelerator:!0,origin:["blog.redish101.top"],mode:"npm",mirrors:[],npm:{accelerator:!0,package:"redish101-blog",version:void require("axios").get("https://api.redish101.top/blog/get_newest_version/").then((function(e){return e.data}))}}};e.blog.npm.urls=[`https://npm.elemecdn.com/${e.blog.npm.package}@${e.blog.npm.version}/public`,`https://cdn.tianli0.top/npm/${e.blog.npm.package}@${e.blog.npm.version}/public`,`https://cdn.oplog.cn/npm/${e.blog.npm.package}@${e.blog.npm.version}/public`,`https://fastly.jsdelivr.net/npm/${e.blog.npm.package}@${e.blog.npm.version}/public`,`https://unpkg.com/${e.blog.npm.package}@${e.blog.npm.version}/public`],self.addEventListener("install",(async function(t){self.skipWaiting(),t.waitUntil(caches.open(e.cache.name).then((e=>e.addAll([]))))})),self.addEventListener("fetch",(async e=>{try{e.respondWith(n(e.request))}catch(n){e.respondWith(t(e.request,n))}}));const t=async(e,t)=>new Response(`<h1>Redish101 Blog Helper Error</h1>\n    <b>${t}</b>`,{headers:{"content-type":"text/html; charset=utf-8"}}),n=async t=>{const n=new URL(t.url),c=n.toString(),o=(n.pathname,n.hostname);let r=[];return e.accelerator.forEach((e=>{e.forEach((t=>{c.match(t)&&e.forEach((e=>{r.push(c.replace(t,e))}))}))})),r.length>0?caches.open(e.cache.name).then((n=>n.match(c).then((n=>n||s(r,c).then((async n=>(e.cache.enabled&&await caches.open(e.cache.name).then((e=>{e.put(t,n.clone())})),n))))))):e.blog.accelerator&&e.blog.origin.includes(o)?caches.open(e.cache.name).then((l=>l.match(c).then((l=>new Promise(((p,h)=>{l&&setTimeout((()=>{p(l)}),20),setTimeout((()=>{"mirror"===e.blog.mode&&e.blog.mirrors.forEach((e=>{r.push(c.replace(o,e))})),"npm"===e.blog.mode&&e.blog.npm.urls.forEach((e=>{r.push(a(e,n))})),r.push(c),s(r,c).then((async s=>{let c;c=a("",n).endsWith(".html")?new Response(await s.arrayBuffer(),{headers:{"content-type":"text/html; charset=utf-8","cache-control":"max-age=0",Server:"Redish101BlogHelper"}}):s.clone(),e.cache.enabled&&await caches.open(e.cache.name).then((async e=>{e.put(t,c.clone())})),p(c)}))}),0)})))))):fetch(t)},a=(e,t)=>{let n=t.pathname.split("#")[0];return n.endsWith("/")&&(n+="index"),n.split("/")[n.split("/").length-1].includes(".")||(n+=".html"),e+n},s=async(e,t)=>{let n=new AbortController;const a=async e=>new Response(await e.arrayBuffer(),{status:e.status,headers:e.headers});return Promise.any||(Promise.any=function(e){return new Promise(((t,n)=>{let a=(e=Array.isArray(e)?e:[]).length,s=[];if(0===a)return n(new AggregateError("All promises were rejected"));e.forEach((e=>{e.then((e=>{t(e)}),(e=>{a--,s.push(e),0===a&&n(new AggregateError(s))}))}))}))}),Promise.any(e.map((e=>new Promise(((t,s)=>{fetch(e,{signal:n.signal}).then(a).then((e=>{200==e.status?(n.abort(),t(e)):s(e)}))})))))}})();